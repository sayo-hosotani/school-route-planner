# TODO リスト

> 完了済みタスクは [DONE.md](./DONE.md) を参照

## 作業方針
- **タスクは1つずつ進める**: 完了するごとにユーザーが確認してコミットするため、複数タスクを一気に進めない

## 1. UI/UX改善（優先度: 低）

### 1.1. エラーハンドリング・ローディング ✅
- [x] API呼び出しエラー時の表示
- [x] バリデーションエラーの表示
- [x] 経路生成中のインジケーター
- [x] データ読み込み中のスケルトン表示

### 1.2. 新機能
- [ ] 地図画像ダウンロード機能
  - 表示中の経路をPNG画像としてダウンロード
  - Scale以外のコントロール（Zoom、Coordinate、Attribution等）を非表示にして画像化
  - leaflet-imageやhtml2canvasなどのライブラリを検討
- [ ] 経路上にポイントをフィットさせるボタンの追加

### 1.3. サイドバーの改善（継続）
- [x] 通常モードと編集モードでコンポーネントを分離
  - `ViewModeSection.tsx`: 保存ボタン + 保存済み経路一覧
  - `EditModeSection.tsx`: クリアボタン + ポイント一覧
  - 通常モードではポイント一覧を非表示に変更
- [x] propsの整理
  - `SidebarProps`を14個→8個に削減
  - `PointHandlers`, `RouteHandlers`型でグループ化
- [x] カスタムフックの抽出
  - `useSavedRoutes`: フェッチ・削除ロジック
  - `useCommentEditor`: コメント編集ロジック
- [ ] コメント表示/編集周りのUIの改善検討
- [ ] キーボードナビゲーション対応（Tab、Enter、Escape）
- [ ] パフォーマンス最適化
  - 不要な再レンダリングの防止

## 2. 認証機能（優先度: 低）
- [ ] ユーザー登録・ログイン画面
- [ ] JWT認証実装
  - @fastify/jwtプラグイン導入
  - ログイン/登録エンドポイント
- [ ] フロントエンド: 認証状態管理
  - トークンの保存（localStorage）
  - APIリクエストにトークン付与
- [ ] 認証が必要なエンドポイントに認証チェック追加

## 3. テスト（優先度: 低）
- [ ] バックエンドのテスト
  - ルートのテスト
  - サービス層のテスト
- [ ] フロントエンドのテスト
  - コンポーネントのテスト

## 4. 本番環境準備（優先度: 低）
- [ ] 本番ビルドスクリプト作成
  - フロントエンドビルド → バックエンドpublicにコピー
- [ ] 静的ファイル配信設定
  - @fastify/staticプラグイン導入
  - publicディレクトリの配信設定
- [ ] 環境変数管理
  - .env.example作成
  - 本番用の環境変数設定
- [ ] デプロイ手順書作成

## メモ
- CLAUDE.mdに設計が詳しく記載されている
- バックエンドAPI: http://localhost:3000
- フロントエンド: http://localhost:5173
- 開発時の起動: `npm run dev:all`
